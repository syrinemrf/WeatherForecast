<!DOCTYPE html> 

<html lang="en"> 

<head> 

    {% load static %} 

    <meta charset="UTF-8"/> 

    <meta name="viewport" content="width=device-width, initial-scale=1.0"/> 

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"> 

    <link rel="icon" href="{% static 'img/site-pic.ico' %}" type="image/icon type"/> 

    <link rel="stylesheet" href="{% static 'css/styles.css' %}"> 

    <title>M√©t√©o √† {{ city }} - {{ description }}</title> 

</head> 

<body> 

    <main class="{{ description }}"> 

        <section class="side-container"> 

            <!-- 1. Barre de recherche --> 

            <form method="POST"> 

                {% csrf_token %} 

                <div class="search-container"> 

                    <div class="weather-icon" style="width: 22px; height: 22px; color: rgba(249, 247, 247, 0.8);"> 

                        <i class="bi bi-geo-alt"></i> 

                    </div> 

                    <input 

                        type="text" 

                        name="city" 

                        class="geo-input" 

                        placeholder="ex. Nabeul" 

                        value="{{ location }}" 

                    /> 

                    <button class="search-button"> 

                        <div class="search-icon"> 

                            <i class="bi bi-search"></i> 

                        </div> 

                    </button> 

                </div> 

            </form> 

 

            <!-- Bloc affichant le message d'erreur s'il y en a --> 

            {% if error_message %} 

                <div class="error" style="color: red; font-weight: bold; margin: 15px 0;"> 

                    {{ error_message }} 

                </div> 

            {% endif %} 

 

            <!-- 2. Donn√©es m√©t√©o principales --> 

            <div class="day-stats"> 

                <h2 class="day-stats__temperature"> 

                    <span class="day-stats__temperature_value">{{ current_temp }}</span>¬∞ 

                </h2> 

                <h3 class="day-stats__feelslike"> 

                    Ressenti :&nbsp;<span class="day-stats__feelslike_value">{{ feels_like }}</span>¬∞ 

                </h3> 

                <ul class="day-stats_conditions"> 

                    <li> 

                        <p class="day-stats_condition"> 

                            <span class="day-stats__humidity">{{ humidity }} %</span> 

                        </p> 

                        <p class="day-stats__condition_text"> Humidit√©</p> 

                    </li> 

                    <li> 

                        <p class="day-stats_condition"> 

                            <span class="day-stats__clouds">{{ clouds }} % </span> 

                        </p> 

                        <p class="day-stats__condition_text"> Nuages</p> 

                    </li> 

                </ul> 

            </div> 

 

            <!-- 3. Qualit√© de l'air (nouvelle position en bas) --> 

            {% if air_quality %}
            <div class="air-quality-card" style="--aq-color: {{ air_quality.color }};">
                <div class="air-quality-header">
                    <div class="aq-title-container">
                        <i class="bi {{ air_quality.icon }} aq-main-icon"></i>
                        <h3>Qualit√©<br>de l'air</h3>
                    </div>
                    <span class="aq-level">{{ air_quality.text }}</span>
                </div>
                
                <p class="aq-description">{{ air_quality.description }}</p>
                
                <div class="pollutants-grid">
                    <div class="pollutant-item">
                        <span>PM2.5</span>
                        <span class="pollutant-value">{{ air_quality.pollutants.pm2_5|floatformat:1 }}</span>
                        <span class="pollutant-unit">Œºg/m¬≥</span>
                    </div>
                    <div class="pollutant-item">
                        <span>PM10</span>
                        <span class="pollutant-value">{{ air_quality.pollutants.pm10|floatformat:1 }}</span>
                        <span class="pollutant-unit">Œºg/m¬≥</span>
                    </div>
                    <div class="pollutant-item">
                        <span>NO‚ÇÇ</span>
                        <span class="pollutant-value">{{ air_quality.pollutants.no2|floatformat:1 }}</span>
                        <span class="pollutant-unit">Œºg/m¬≥</span>
                    </div>
                </div>
            </div>
            {% endif %} 

 

            <img src="{% static 'img/side-blur.png' %}" class="side-blur" alt="D√©coration floue de la barre lat√©rale"/> 

        </section> 

 

        <section class="main-container"> 

            <h4 class="secondary-title">M√©t√©o</h4> 

                        <!-- Conteneur pour la description et les informations m√©t√©o -->
            <div class="weather-info-container">
                <h1 class="weather__primary_title">{{ description }}</h1>

                <div class="weather__location">
                    <div class="location-icon" style="width: 15px; height: 15px; color: white;">
                        <i class="bi bi-geo-alt"></i>
                    </div>

                    <p class="weather__location-text">
                        <span class="weather__location-city">{{ city }}</span>
                        <span class="weather__location-country">{{ country }}</span>
                        <span class="weather__location-date">{{ time }}</span>
                    </p>
                </div>

                

                <p class="weather__primary-stats">
                    üí® <strong>Vent :</strong> <span class="weatherWindKph">{{ wind }}</span> km/h  &nbsp;&nbsp;|&nbsp;&nbsp;
                    üß≠ <strong>  Pression :</strong> <span class="weatherPressure">{{ pressure }}</span> mb &nbsp;&nbsp;|&nbsp;&nbsp;
                     <strong>   üëì Visibilit√© :</strong> <span class="weatherSnow">{{ visibility }}</span> &nbsp;&nbsp;|&nbsp;&nbsp;
                    üå°Ô∏è <strong>Temp√©rature Max :</strong> <span class="weatherMaxTemp">{{ MaxTemp }}</span>¬∞ &nbsp;&nbsp;|&nbsp;&nbsp;
                    üßä <strong>Temp√©rature Min :</strong> <span class="weatherMinTemp">{{ MinTemp }}</span>¬∞.
                </p>
                
            </div>
 
        
            


 

            <ul class="forecast"> 

                <li class="forecast-item"> 

                    <p class="forecast-time">{{ time1 }}</p> 

                    <p class="forecast-temperature"> 

                        <span class="forecast-temperatureValue">{{ temp1 }}</span>¬∞ 

                    </p> 

                    <p class="forecastWindText"> 

                        Humidit√© : <span class="forecast-humidityValue">{{ hum1 }}</span>% 

                    </p> 

                </li> 

                <li class="forecast-item"> 

                    <p class="forecast-time">{{ time2 }}</p> 

                    <p class="forecast-temperature"> 

                        <span class="forecast-temperatureValue">{{ temp2 }}</span>¬∞ 

                    </p> 

                    <p class="forecastWindText"> 

                        Humidit√© : <span class="forecast-humidityValue">{{ hum2 }}</span>% 

                    </p> 

                </li> 

                <li class="forecast-item"> 

                    <p class="forecast-time">{{ time3 }}</p> 

                    <p class="forecast-temperature"> 

                        <span class="forecast-temperatureValue">{{ temp3 }}</span>¬∞ 

                    </p> 

                    <p class="forecastWindText"> 

                        Humidit√© : <span class="forecast-humidityValue">{{ hum3 }}</span>% 

                    </p> 

                </li> 

                <li class="forecast-item"> 

                    <p class="forecast-time">{{ time4 }}</p> 

                    <p class="forecast-temperature"> 

                        <span class="forecast-temperatureValue">{{ temp4 }}</span>¬∞ 

                    </p> 

                    <p class="forecastWindText"> 

                        Humidit√© : <span class="forecast-humidityValue">{{ hum4 }}</span>% 

                    </p> 

                </li> 

                <li class="forecast-item"> 

                    <p class="forecast-time">{{ time5 }}</p> 

                    <p class="forecast-temperature"> 

                        <span class="forecast-temperatureValue">{{ temp5 }}</span>¬∞ 

                    </p> 

                    <p class="forecastWindText"> 

                        Humidit√© : <span class="forecast-humidityValue">{{ hum5 }}</span>% 

                    </p> 

                </li> 

            </ul> 

 

            <canvas id="chart" height="45px"></canvas> 

        </section> 

    </main> 
    <!-- Ic√¥ne d'aide en haut √† droite -->
<!-- Ic√¥ne d'aide en haut √† droite --> 
<div id="help-icon" style="position: fixed; top: 50px; right: 250px; cursor: pointer; color: white; font-size: 1.8rem; z-index: 1000;">
    <i class="bi bi-question-circle-fill"></i>
</div>

<!-- Fen√™tre modale -->
<div id="help-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
     background: rgba(0, 0, 0, 0.5); z-index: 1001; justify-content: center; align-items: center;">
    <div style="background: rgba(255, 255, 255, 0.8); 
    color: #222; 
    padding: 30px; 
    border-radius: 16px; 
    max-width: 600px; 
    width: 90%;
    text-align: left; 
    position: relative; 
    font-family: 'Segoe UI', sans-serif; 
    box-shadow: 0 8px 16px rgba(0,0,0,0.2); 
    backdrop-filter: blur(10px); 
    -webkit-backdrop-filter: blur(10px);">

        
        <button id="close-help" style="position: absolute; top: 10px; right: 15px; background: transparent; border: none; font-size: 1.5rem; cursor: pointer; color: #666;">
            &times;
        </button>
        
        <h2 style="margin-top: 0; color: #1e90ff;">√Ä propos de SmartWeather</h2>
        
        <p style="margin-bottom: 1em;"><strong>üìä Donn√©es m√©t√©o :</strong> Toutes les donn√©es affich√©es sont r√©cup√©r√©es en <u>temps r√©el</u> gr√¢ce √† des capteurs locaux et des APIs fiables.</p>
        
        <p style="margin-bottom: 1em;"><strong>üß† Mod√®les de pr√©diction utilis√©s :</strong></p>
        <ul style="margin-left: 1.5em; margin-bottom: 1em;">
            <li><strong>R√©gression lin√©aire :</strong> pour estimer la temp√©rature et l‚Äôhumidit√© </li>
            <li><strong>Random Forest Classifier :</strong> pour pr√©dire la probabilit√© de pluie </li>
        </ul>

        <p style="margin-bottom: 0.5em;"><strong>ü´Å Indicateurs de qualit√© de l'air :</strong></p>
        <ul style="margin-left: 1.5em;">
            <li><strong>PM2.5 :</strong> Particules fines inf√©rieures √† 2.5 microns. Peuvent p√©n√©trer profond√©ment dans les poumons.</li>
            <li><strong>PM10 :</strong> Particules inf√©rieures √† 10 microns. Affectent les voies respiratoires sup√©rieures.</li>
            <li><strong>NO‚ÇÇ :</strong> Dioxyde d‚Äôazote. Produit par les moteurs et industries. Irritant pour les poumons.</li>
        </ul>
    </div>
</div>



 

    <!-- Donn√©es m√©t√©o pour le graphique --> 

    <script> 

        const chartData = { 

            labels: ["{{ time1 }}", "{{ time2 }}", "{{ time3 }}", "{{ time4 }}", "{{ time5 }}"], 

            temperatures: [{{ temp1 }}, {{ temp2 }}, {{ temp3 }}, {{ temp4 }}, {{ temp5 }}], 

            humidity: [{{ hum1 }}, {{ hum2 }}, {{ hum3 }}, {{ hum4 }}, {{ hum5 }}] 

        }; 

    </script> 

 

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> 

    <script type="module" src="{% static 'js/chartSetup.js' %}"></script> 
    <script>
        const helpIcon = document.getElementById("help-icon");
        const helpModal = document.getElementById("help-modal");
        const closeHelp = document.getElementById("close-help");
    
        helpIcon.addEventListener("click", () => {
            helpModal.style.display = "flex";
        });
    
        closeHelp.addEventListener("click", () => {
            helpModal.style.display = "none";
        });
    
        window.addEventListener("click", (e) => {
            if (e.target === helpModal) {
                helpModal.style.display = "none";
            }
        });
    </script>
    

</body> 

</html> 